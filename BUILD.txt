BUILD INSTRUCTIONS
------------------

1. make


NOTES FOR WINDOWS
-----------------

1. Native binaries can be built by cross-compiling on Linux or by installing the
   MinGW toolchain on Windows. For the latter option first download MSYS2 from
   https://www.msys2.org/ and then follow website instructions on how to install
   the mingw-64 GCC.

2. For building the plugin, Edge WebView2 SDK is required. Makefile will try to
   download the SDK if the NuGet tool is already present. If not, NuGet will be
   automatically downloaded for MinGW but on Linux that could need extra work
   https://docs.microsoft.com/en-us/nuget/install-nuget-client-tools
   Some distros like Ubuntu already offer it: sudo apt install nuget

   Running MinGW on Windows 7 can cause nuget.exe to fail due to a TLS error, in
   such case here is the fix: https://github.com/NuGet/NuGetGallery/issues/8176

   The SDK can also be downloaded using the free Visual Studio Community IDE:

   - Create Project
   - Right click on solution
   - Manage NuGet packages
   - Find and install Microsoft.Web.WebView2
   - Copy < SOLUTION_DIR >/packages/Microsoft.Web.WebView2.< VERSION > to
     < PLUGIN_DIR >/lib/Microsoft.Web.WebView2  (version suffix stripped)

3. For running the plugin, the Microsoft Edge WebView2 Runtime must be installed
   on the host machine https://developer.microsoft.com/microsoft-edge/webview2

4. The official binary distribution of Wasmer requires MSVC. Compiling Wasmer
   is a complex process beyond the scope of this project. To solve the issue
   the Makefile downloads a custom MinGW compatible build. If building Wasmer
   from source is needed, here are the instructions:

   https://stackoverflow.com/questions/47379214/step-by-step-instruction-to
   -install-rust-and-cargo-for-mingw-with-msys2

   - wget -O rustup-init.exe https://win.rustup.rs/
   - ./rustup-init   (select host triple: x86_64-pc-windows-gnu)
   - export PATH="/c/Users/< USERNAME >/.cargo/bin:$PATH"
   - git clone https://github.com/wasmerio/wasmer
   - make -C wasmer
   - mkdir -p apices/lib/wasmer/include
   - cp wasmer/lib/c-api/tests/wasm-c-api/include/wasm.h apices/lib/wasmer/include
   - cp wasmer/lib/c-api/wasmer.h apices/lib/wasmer/include
   - mkdir -p apices/lib/wasmer/lib
   - cp wasmer/target/release/libwasmer.a apices/lib/wasmer/lib
